---
title: 竞赛算法(4) 数论
published: 2025-11-24
description: ''
image: ''
tags: []
category: ''
draft: false 
lang: ''
---
## 欧拉函数
一种数论函数, 记作$\varphi(n)$, 是一种积性函数, 其含义为小于等于n的正整数中与n互质的数的个数.

:::note[欧拉函数的性质]
1. 欧拉函数是积性函数. 特别地, 当$n$为奇数时, $\varphi(2n) = \varphi(n)$.
2. $n = \displaystyle\sum_{d|n}\varphi(d)$. 即恒等函数$id$是常数函数$1$和欧拉函数$\varphi$的狄利克雷卷积.
3. 若$n = p^k$, 则$\varphi(n) = p^k - p^{k - 1}$.
4. $\varphi(n)$等于$n$除以所有不同的质因数, 再乘以所有不同质因数-1的结果.
:::

## 欧拉筛
```cpp
vector<int> primes;
int minp[N];
auto euler = [&](int n) -> void {
    for (int i = 2; i <= N; i++) {
        if (minp[i] == 0) {
            primes.push_back(i);
            minp[i] = i;
        }
        for (int j = 0; primes[j] <= minp[i] && 1LL * i * primes[j] <= n; j++) {
            minp[i * primes[j]] = primes[j];
        }
    }
};
```
## 数论函数
正整数到正整数的函数. 可以被看作一个数列.

### 积性函数
1. $f(1) = 1$.
2. 对于互质的$x$, $y$, 有$f(xy) = f(x)f(y)$.

:::note[完全积性函数]
1. $f(1) = 1$.
2. 对于任意的$x$与$y$, 有$f(xy) = f(x)f(y)$.
:::

:::note[积性函数的性质]
若$f(x), g(x)$都是积性函数:
1. $f(x^p)$也是积性函数.
2. $f^p(x)$也是积性函数.
3. $f(x)g(x)$也是积性函数.
4. $\displaystyle \sum _{d|x}f(d)g(\frac{x}{d})$也是积性函数.
5. 容易注意到正整数在唯一分解后, 积性函数等于其每一个质因数幂次的函数值相乘, 完全积性函数还等于其每一个质因数的函数值相乘.
:::

:::note[常见的积性函数]
1. 单位函数$\epsilon (n) = [n = 1].$即$n = 1$的指示函数. 为完全积性函数.
2. 恒等函数$id_k(n) = n^k, id(n) = n$. 完全积性.
3. 常数函数$1(n) = 1$. 完全积性.
4. 除数函数$\displaystyle \sigma _k(n) = \sum _{d|n}d^k$. 其中$\sigma _0(n)$常记作$d(n)$或$\tau(n)$, $\sigma_1(n)$常记作$\sigma(n)$.
5. 欧拉函数$\varphi(n) = \displaystyle\sum_{i = 1}^{n}[gcd(i, n) = 1]$.
6. 莫比乌斯函数$\mu (n)$. $n$为$1$时值为$1$, $n$为完全平方数的整数倍时值为$0$, 其他时候值为$(-1)^k$, 其中$k$为$n$的不相等质因子个数.
:::

## 整除分块(数论分块)
以$O(\sqrt{n})$的复杂度计算$\displaystyle\sum_{i=1}^nf(i)g(\lfloor \frac{n}{i}\rfloor)$.
```cpp
for (int l = 1, r; l <= n; l = r + 1) {
    // fpre(x) 为 f(x)的前缀和函数.
    int q = n / l;  // 先得到 n / i 向下取整.
    r = n / q;
    r = min(r, n);  // 再得到 q 这个值对应的 i 范围, 为 [l, r]
    sum += (fpre(r) - fpre(l - 1)) * g(q);
}
```

## 狄利克雷卷积
数论函数$f(n)$与$g(n)$的狄利克雷卷积记作$f*g$, 定义为$\displaystyle\sum_{k|n}f(k)g(\frac{n}{k}) = \sum_{kl=n}f(k)g(l)$.

:::note[常见的狄利克雷卷积]
1. 单位函数$\varepsilon$是默比乌斯函数$\mu$和常数函数$1$的狄利克雷卷积:$$\varepsilon = \mu * 1 \iff \varepsilon(n) = \displaystyle\sum_{d|n}\mu(d)$$
2. 除数函数$d$是常数函数$1$和$1$的狄利克雷卷积:$$d(n) = \displaystyle\sum_{d|n}1$$
3. 除数和函数$\sigma$是恒等函数$id$和$1$的狄利克雷卷积:$$\sigma(n) = \displaystyle\sum_{d|n}d$$.
4. 欧拉函数$\varphi$是恒等函数$id$和莫比乌斯函数$\mu$的狄利克雷卷积:$$\varphi(n) = \displaystyle\sum_{d|n}d\mu(\frac{n}{d})$$
5. gcd和函数$P(n) = \displaystyle\sum_{i=1}^ngcd(i, n)$是恒等函数$id$与欧拉函数$\varphi$的狄利克雷卷积.
:::

:::note[狄利克雷卷积的性质]
1. 交换律
2. 结合律
3. 对加法的分配律
4. 存在单位元, 为单位函数$\varepsilon$
5. 在$f(1)\ne 0$时存在逆元, 成为狄利克雷逆元. 逆元满足递推公式$$\displaystyle g(n) = \frac{\varepsilon(n) - \sum_{kl = n, k \ne 1}f(k)g(l)}{f(1)}$$
:::

如上性质表明全体数论函数在加法运算和狄利克雷卷积运算下构成**交换环**, 称为**狄利克雷环**.