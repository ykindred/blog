---
title: 数据结构C(1) 线性表的实现(待完善)
published: 2025-09-14
description: ''
image: ''
tags: []
category: ''
draft: false 
lang: ''
---


```C
// list.c

#include <malloc.h>
#include <stdbool.h>
#include "list.h"

ContList *InitList() {
    ContList* list = malloc(sizeof(ContList));
    return list;
}

ContList *DestroyList(ContList *L) {
    free(L->arr);
    free(L);
    return NULL;
}

ContList *ClearList(ContList *L) {
    free(L->arr);
    L->size = 0;
    return L;
}

bool ListEmpty(ContList *L) {
    return L->size == 0;
}

size_t ListLength(ContList *L) {
    return L->size;
}

elem_t GetItem(ContList *L, size_t i) {
    return (L->arr)[i - 1];
}

elem_t PriorElem(ContList *L, elem_t cur_e) {
    for (int i = 1; i < L->size; i++) {
        if (L->arr[i] == cur_e) {
            return L->arr[i - 1];
        }
    }
    return ERROR;
}

elem_t NextElem(ContList *L, elem_t cur_e) {
    if (L->size == 0) {
        return ERROR;
    }
    for (int i = 0; i < L->size - 1; i++) {
        if (L->arr[i] == cur_e) {
            return L->arr[i + 1];
        }
    }
    return ERROR;
}

void ListInsert(ContList *L, size_t m, elem_t e) {
    if (ListEmpty(L)) {
        L->size++;
        L->arr = malloc(sizeof(elem_t));
        L->arr[0] = e;
        return;
    }
    elem_t *old = L->arr;
    L->size++;
    L->arr = malloc(L->size * sizeof(elem_t));
    int flag = 0;
    for (int i = 0; i < L->size; i++) {
        if (i == m - 1) {
            L->arr[i] = e;
            flag = 1;
            continue;
        }
        L->arr[i] = old[i - flag];
    }
    free(old);
}

void ListDelete(ContList *L, size_t m) {
    if (ListEmpty(L)) {
        ClearList(L);
        return;
    }
    elem_t *old = L->arr;
    L->size--;
    L->arr = malloc(L->size * sizeof(elem_t));
    int flag = 0;
    for (int i = 0; i < L->size; i++) {
        if (i == m - 1) {
            flag = 1;
            continue;
        }
        L->arr[i] = old[i + flag];
    }
    free(old);
}

void func(const elem_t *a) {
    printf("%d ", *a);
}

void TraverseList(ContList *L) {
    for (int i = 0; i < L->size; i++) {
        func(&L->arr[i]);
    }
}
```

```C
// list.h

#ifndef DATA_STRUCTURE_LIST_H
#define DATA_STRUCTURE_LIST_H

#include <malloc.h>
#include <stdbool.h>
#define OK 0
#define ERROR (-1)
#define OVERFLOW (-2)
typedef int status;
typedef unsigned long size_t;
typedef int elem_t;
typedef struct{
    elem_t *arr;
    size_t size;
} ContList;
ContList *InitList();
ContList *DestroyList(ContList *L);
ContList *ClearList(ContList *L);
bool ListEmpty(ContList *L);
size_t ListLength(ContList *L);
elem_t GetItem(ContList *L, size_t i);
elem_t PriorElem(ContList *L, elem_t cur_e);
elem_t NextElem(ContList *L, elem_t cur_e);
void ListInsert(ContList *L, size_t m, elem_t e);
void ListDelete(ContList *L, size_t m);
void func(const elem_t *a);
void TraverseList(ContList *L);

#endif //DATA_STRUCTURE_LIST_H

```

```C
// main.c
#include <stdio.h>
#include "list.h"
int main() {
    void *L = InitList();
    for (int i = 1; i <= 10; i++) {
        ListInsert(L, i, i);
    }
    TraverseList(L);
    printf("%d ", NextElem(L, 5));
    printf("%d ", NextElem(L, 0));
    printf("%d ", NextElem(L, 10));
    printf("%d ", PriorElem(L, 5));
    printf("%d ", PriorElem(L, 0));
    printf("%d ", PriorElem(L, 10));
    for (int i = 1; i <= 10; i++) {
        ListDelete(L, i);
    }

    TraverseList(L);

    DestroyList(L);
    return 0;
}
```