---
title: 算法导论(4) 数值计算杂项
published: 2025-09-17
description: '世界的真理或许不能被完美表示出来, 但永远能被逼近.'
image: ''
tags: []
category: ''
draft: false 
lang: ''
---

本文的内容比较杂乱, 但都是干货.

## 数值计算
我们知道, 计算机中的数据是离散的(所有数据本质上都是二进制整数). 对于有理数, 我们可以使用两个整数的比值来精确表示, 但无理数呢? 我们只能进行**近似**, 如何用离散的计算机来处理(精确近似, 高效计算)无理数这样连续的数据, 是数值计算的核心课题.

## 牛顿法
用于求方程$f(x) = 0$的数值解的方法, 可以用来做很多事.

比如, 要计算$\sqrt{2}$, 只需求出方程$x^2 - 2 = 0$的根即可.

:::tip[牛顿法的步骤]
1. 猜测一个根$x_0$.
2. 判断这个根是否就是答案(满足精度要求).
3. 若不满足, 在$x_0$处建立$f(x)$的切线. 求出切线与$x$轴的交点$x_{1}$
4. 将$x_{1}$作为新的猜测值, 重复步骤2.
:::

公式为
$$
x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)}
$$

牛顿法的收敛速度极快. 每次迭代正确的有效数字位数大约会翻一倍, 这种收敛速度被称为**二次收敛(Quadratic convergence)**.

## 高精度计算
我们主要研究高精度乘.

默认读者已经掌握基本的高精度乘法, 比如竖式法.

竖式法的时间复杂度: $O(n^2)$

简单地对高精度乘进行分治并不能改变这个时间复杂度, 依然是$O(n^2)$.

:::tip[分治高精度乘(Karatsuba算法)]
1. 将$r$进制下$n$位(n为偶数)的数$x$分成两个$\frac{n}{2}$位的数, 高位记作$x_1$, 低位记作$x_0$. $x = x_1r^{n/2} + x_0$. 同理$y = y_1r^{n/2} + y_0$
2. 相乘$x$与$y$, 展开, 得到$xy = x_1r^{n/2}y_1r^{n/2} + x_0y_1r^{n/2} + y_0x_1r^{n/2} + x_0y_0 = x_1y_1r^n + (x_0y_1 + y_0x_1)r^{n/2} + x_0y_0$.
3. 常规分治需要做4次乘法$x_1y_1, x_0y_1, y_0x_1, x_0y_0$, 这样做的复杂度是$T(n) = 3T(\frac{n}{2}) + O(n)$, 这导致总的时间复杂度依然是$O(n^2)$.
4. Karatsuba注意到, 我们计算$x_0y_1 + y_0x_1$其实不需要2次乘法!
5. 先计算$x_1y_1, x_0y_0$, 分别记为$z_1$和$z_2$(第一次乘法和第二次乘法), 再计算$z_3 = (x_0 + x_1)(y_0 + y_1)$(第三次乘法)
6. 我们将$z_3$展开, $z_3 = x_0y_0 + x_0y_1 + x_1y_0 + x_1y_1$, 移项后就有$x_0y_1 + x_1y_0 = z_3 - z_1 - z_2$
7. 于是我们只用了3次乘法和一些额外的加减法就得到了原来的结果.
8. 复杂度分析: $T(n) = 3T(\frac{n}{2}) + O(n)$, 最后得到$T(n) = O(n^{\log_2{3}}) \approx O(n^{1.585})$
:::
Karatsuba算法目前被用于python大数乘法的部分实现. 这是一个革命性的突破. 它第一次向世界展示: 我们长期以来认为最优的算法, 可能并非最优. 在Karatsuba算法提出以后, 才出现了更多对高精度乘法时间优化的算法, 包括渐进更优的 Schönhage–Strassen(SSA) 算法 $(O(n \log n \log \log n))$ 和 Fürer 算法(非常接近$O(n\log n)$). 我们可以猜测, 高精度乘法算法应该有一个$O(n\log n)$的理论下界.

## 卡特兰数
总之是一种数列, 会出现在各类奇怪的问题里.
1. 给定$n$对括号, 问有多少种合法的(正确匹配的)括号序列组合? 
   1. n = 1, ans = 1,
   2. n = 2, ans = 2,
   3. n = 3, ans = 5,
   4. n = 4, ans = 14
   5. ...
2. 在一个$n \times n$并且只有一半的三角形方格网(包括对角线)上, 每次只能向上或向右走一步, 从左下角 $(0,0)$ 走到右上角 $(n,n)$的方案数.![catalan](./6.006photos/catalan.png)
   1. n = 1, ans = 1,
   2. n = 2, ans = 2,
   3. n = 3, ans = 5,
   4. n = 4, ans = 14
   5. ...
3. n个节点的二叉树形态数
4. n+1个叶子的满二叉树形态数
5. 凸n+2边形的三角剖分数
6. n个数的出栈序列数
7. ...

这些问题都具有某种非负的排列限制, 答案都满足1, 2, 5, 14, ...这样的规律, 这个数列就是**卡特兰数(Catalan Numbers)**.

### 通项公式
$$C_n = \frac{1}{n+1} \binom{2n}{n} = \frac{(2n)!}{(n+1)!n!}$$

### 标准递推式
$$C_0=1, \quad C_{n+1} = \frac{2(2n+1)}{n+2} C_n$$

### 一种计算更优的递推式
笔者在做[luogu-P1044](https://www.luogu.com.cn/record/219366312) 时发现的, 相邻两项比值的规律.
$$
C_0=1, \quad C_n = \frac{4n - 2}{n + 1}C_{n - 1}
$$